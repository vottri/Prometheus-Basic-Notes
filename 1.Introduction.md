# Introduction

## What is Prometheus?

Prometheus is an open-source monitoring and alerting tool. It collects data about your systems and applications and allows you to visualize the data and issue alerts based on the data.

## Metrics

The data about systems and applications that you want Prometheus to monitor is called a metric. Prometheus collects and stores metrics as time-series data in a time-series database (designed for time-series data). Time series data means that all the metrics are stored along with a timestamp at when it was recorded, so it can be easily queried using time ranges.

In its most basic form, a metric is made of: A metric name, The timestamp when metric data was collected, A measurement represented by a numeric value.

## Prometheus Components

Prometheus Server: Collects and stores metric data.

Prometheus Targets:

 - Exporters: Provide metric data for Prometheus to collect.

 - Client libraries: Turn your custom application into an exporter that exposes metrics in a format Prometheus can con collect.

 - Pushgateway: Allows pushing metrics to Prometheus for certain specific use cases.

Alert Manager: Sends alerts triggered by collected metric data.

Visualization UI: Visualize the collected metric data. You can use other thid-party tools for this.

## Prometheus Server:

Prometheus runs a whole lot of functions inside one server. 

One of them is a scheduler component which fetches metrics from the systems and applications that you want to monitor (Prometheus calls those systems and applications the targets, and the act of collecting the metrics is called scraping).

Prometheus uses a pull model, so you need to expose metrics from your systems and applications, and then Prometheus will periodically go and scrape them. Scrapes happen regularly at given intervals; usually you would configure it to happen every 30 to 60 seconds for each target.

Everything about the targets that you want to monitor is stored in the Prometheus configuration file, which uses the YAML format. In there, you tell Prometheus how to find the targets, how often it should scrape them, and what it should do which the metrics it scrapes.

After scraping them, Prometheus stores all those metrics in a time series database, which is also running in the server. Remote storage repositories can also be coupled with Prometheus. 

Once the scraped metric is stored, you can queries them using PromQL. Prometheus has its own query language, because time series data doesn't really fit well with standard SQL. Prometheus can also display collected data in its web-based user interface, which lets you view the current values of metrics or have them visualized in a graph over time. But the Prometheus UI isn't a fully featured dashboard, it is recommended that you use third-party visualization solutions like Grafana for dashboards and actual graphs. 

Lastly, Prometheus has a really advanced alerting system. You register alerting rules in the Prometheus server, and when the rules trigger, Prometheus can send alerts to the Alert Manager, which will then turns them into notifications. Notifications can include email, chat applications such as Slack, and services such as PagerDuty, ...

## Prometheus Targets:

Any systems that you want Prometheus to monitor needs to run an exporter, which provides all its metrics in an HTTP endpoint, Prometheus server then scrapes the metrics from that endpoint on a schedule and store them. 

The scrape_config section of the Prometheus config file provides a list of targets the Prometheus server will scrape. Prometheus Server itself also has a built-in exporter, exporting metrics about its services to which you can view at http://localhost:9090/metrics

For instrumenting your own code, there are client libraries in all the popular languages and runtimes. Client Libraries can turn your custom applications into an exporter that exposes metrics in a format Prometheus can collect. With usually only two or three lines of code, you can embed Prometheus support in your own applications using client libraries.

For every major DevOps tool or third-party software on the market that exposes metrics in a non-Prometheus format, there is a specific exporter available that extracts metrics and makes them Prometheus compatible (include HAProxy, MySQL, Redis, SNMP, Consul, and Kafka, ...). The most common of these is the Node Exporter and Windows Exporter, used to expose system metrics (operating system and hardware). 

Example: Linux Server does not expose Prometheus-formatted metrics. Thatâ€™s why Prometheus exporters, like the node exporter, exist. Node Exporter runs on a Linux Server and collects a variety of system metrics. It then exposes them to Prometheus.

The combination of the lightweight server and the wide range of exporters and client libraries means you can pretty much monitor your whole stack, and have the same monitoring solution running in every environment.

## Alert Manager:

## Grafana:

# Lab Setup

This lab was done by renting virtual machines on Microsoft Azure Cloud. You can create a free Azure account for practicing this lab.

## Create a network topology

In the Azure portal, create a new "Virtual Networks" called "myVnet".

Next, create a new "Network Secuirty Group" called "myNSG". Add the necessary inbound security rules as below.


## Add VMs to topology

Create two virtual machines installed Ubuntu Server 20.04 LTS.

Check the VMs for network configuration details.

 sudo access to your system.
Working internet connection as we will download the Prometheus Linux Binary.








